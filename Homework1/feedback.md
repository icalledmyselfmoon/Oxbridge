# 1. EDA
## 1.1
Ты не реализовала график со всеми классами. Синтаксим не очень сложный, и он есть в документации.

Помимо того, что написано в [документации](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html), для лучшей визуализации может быть удобнее отключать отображение осей на картинках, как вариант:
```{python}
ax..set_title(<lable of a subplot>)
ax.axis("off")
```

Еще я бы рекомендовал выносить в отдельную переменную вычисление рисунка, это улучшит читаемость.

## 1.2
EDA у тебя реализован неправильно. Во-первых, твоя команда делает совсем не то - она считает статистики (среднее и всякие квантили) для КАЖДОЙ строки отдельно (потому что ты транспонируешь датафрейм). Во-вторых, чтобы нарисовать баланс классов, нужно было пользоваться переменной таргетов - `y` и использовать гистограмму, к примеру. 


## 1.3
Вопросов нет, сплит реализован корректно, еще мне понравилось, как ты сделала кастинг типов - оч круто! Но я бы лучше использовал все же заготовленный сид `SEED`, а не свой, так как тогда у тебя вся работа будет воспроизводиться с одним сидом.

## 1.4 KNN
Мне понравилось, как ты реализовала сплит, отлично!

У меня все функции из твоего файла запустились через интерфейс `knn_classifier` в ноутбуке. Как вариант почему не запустилось - ты рестартнула ноутбук. Я снимаю полбалла - тут важно, чтобы ты в дальнейшем могла сама разобраться в ошибках, которые возникают в коде, потому что сам интерфейс был нами протестирован, и поэтому проблема с твоей стороны. И из-за этого у тебя реализованы функции, которые используются не в классе `knn_classifier`, а извне - а это ошибка. Функции внутри класса у тебя реализованы неправильно. Функция с подсчетом расстояний без циклов ошибка - эта строка не не обобщается на произвольное количество размерностей в векторе - ты же в ней складываешь только первые две координаты:

```{python}
dists =  np.abs(binary_test_X[:,0,None] - binary_train_X[:,0]) + np.abs(binary_test_X[:,1,None] - binary_train_X[:,1])

```


Еще у тебя тут проблемы с размерностями - binary_train_X может неправильно складываться с binary_test_X. Снимаю за это балл, потому что это очень важная реализация, которую к тому же разобрали на консультации.

Функции необходимо было реализовать в файле - это еще и учит декомпозировать код в разные файлы. Я вынужден снять за это еще полбалла, потому что ты не соблюла условия задания (функции нужно импортировать).

В `predict_labels_multiclass` переменная `_binary_train_y` не существует - ты вероятно перепутала и поставила случайно нижнее прдчеркивание. В Функции `predict` ты видимо прото скопировала функцию `compute_distances_two_loops`, чтобы написать `compute_distances_one_loops`, но тут s на конце не нужна. 

Общее замечание, почему мне не нравится, что ты функции перенесла в ноутбук - у тебя внутри функций используются глобаные переменные (та же `binary_train_y`), НО - у тебя входы меняются, то есть ты можешь забыть и в дальнейшем юзать эти функции с другими входными значениями, НО у тебя они ве еще будут привязаны к исходным данным. Интерфейс классов это нивелирует, так как каждый экземпляр класса хранит свои данные. Это оченб важно для понимания дальнейшей работы, в твоем подходе можно запутаться.

Вопрос - можно ли реализовать функцию предикта для бинарной и многоклассовой классификации БЕЗ цикла? Попробуй это сделать.

Ячейка с предсказаниями не работает, потому что у тебя беспорядок в коде, и ты все еще используешь функции из файлика. Минус полбалла.




Метрики для бинарной классификации у тебя в целом должны выдавать правильные результаты. Но у тебя очень уж опасно реализованы `tp` и `fn` -  ты как условие фильтрации используешь бинарный оператор - `&`. Его поведение в твоем случае удовлетворяет целями функции, но это не равно операции `and`!


- НО - у тебя реализовано в цикле, что очень неэффективно. Это можно сделать при помощи векторизованных операций нампая
  - **Переделай в векторый вид, это важно в дальнейшем понимать**
  - Еще у тебя код будет выдавать ошибку, если знаменатил будут нулевые. Это нужно учитывать. про это даже было в описании. Снимаю четверть балла.

В файле с метриками забыла закрывающую скобку в `mae` - снимаю четверть балла за это и за неэффективную реализацию.


Функция `find_best_k` у тебя реализована не до конца правильно - во-первых ты вообще не используешь параметры и работаешь только с глобальными переменными. Во-вторых ты не используешь никак параметр `metric` - это собственно и должна быть функция, которую надо вызывать и которая складывается в `train_metrics` и `test_metrics`. При этом, ты захардкодила так, чтобы у тебя туда всегда складывался f1-score. Это не обобщается и подход рухнет, придется переписывать код, если захочешь другую функцию юзать. Снимаю четверть балла. Почему-то ты пропустила анализ результата.



## 1.5 Multiclass KNN

Функция `multiclass_accuracy` не импортирована. Но и в самое реализации в файле у тебя лишнее - достаточно просто посчиттать `tp`. При этом можно сделать это в векторном виде без цикла - как?

Я вынужден снять балл за неэффиктивную реализацию и ошибки в коде - нужно было лучше разобраться и протестировать ноутбук перед сдачей.


# 2 EDA

## 2.1

EDA отсутствует, пайплайна тоже нет - посмотри пожалуйста в свободное время - это очень важные аспекты в обработке данных и вообще EDA незаменим при первичном осмотре данных.

## 2.2
Пожалуйста, если ты что-то рисуешь - то на будущее - делай подписи. Это важно в том числе и в работе.


## 2.3

- `multiclass_accuracy` реализована неэффективно, можно сделать на голом нампае
- `r_squared` реализовано правильно

Тут баллы не снимаю, до этого уже снял.

## 2.4
Твоя реализация для подбора лучшего k непоказательная - тут можно было воспользоваться позожей реализацией, что и в первой часит ноутбука. И ты почему-то не выбрала в итоге, какой k наиболее оптимальный. Точнее ты сделала это просто как коммент - это совсем не заметно. Но с выбором согласен.

Делай более информативные отчеты! Снимаю четверть балла(



Итог:
- 1.1 - 0.5/0.5
- 1.2 - 0/1
- 1.3 - 0.5/0.5
- 1.4 - 2.75/6 
- 1.5 - 1/2
- 2.1 - 0/4 (за пайплайн +2 и за отсутствие скейлинга и трансформации категориальной фичи -1)
- 2.2 - 1/1
- 2.3 - 3/3 (коэффициент детерминации неправильный, -0.25 за неэффективную реализацию точности)
- 2.4 - 1.75/2
- 3 - 0

ШТРАФ: У тебя нет отдельной папки с кодом и с данными (в данном задании она не то, чтобы нужна, поэтому это ладно), я вынужден снять за это **полбалла**, так как структура проекта должна отделять код от данных и других частей (конфигов, результатов и прочее)

TOTAL: 10.5 - 0.5 = 10 баллов

Из-за дедлайна (ты успела в дедлайн по коэффициенту 0.4) => 4 балла
